<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.font.im/css?family=Poppins:400,900|Raleway|Roboto:400,900|Roboto+Mono" rel="stylesheet">
<link rel="stylesheet" href="/daviddong.github.io/assets/css/style.css">
<link rel="icon" href="/daviddong.github.io/assets/favicon.ico">

	<!-- default stylesheet monokai.sublime ! -->
	
	<link href="/daviddong.github.io/assets/css/syntax/syntax.monokai.sublime.css" rel="stylesheet"/>
	

<title>Use jekyll-toc plugin on Github Pages | David Dong's Blog</title>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Use jekyll-toc plugin on Github Pages | David Dong’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Use jekyll-toc plugin on Github Pages" />
<meta name="author" content="david.dong" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This article introduced how to use jekyll-toc plugin on Github Pages." />
<meta property="og:description" content="This article introduced how to use jekyll-toc plugin on Github Pages." />
<link rel="canonical" href="http://localhost:4000/daviddong.github.io/blog/github/2021/03/14/Blog-Jekyll-toc-plugin.html" />
<meta property="og:url" content="http://localhost:4000/daviddong.github.io/blog/github/2021/03/14/Blog-Jekyll-toc-plugin.html" />
<meta property="og:site_name" content="David Dong’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-14T21:11:16+08:00" />
<script type="application/ld+json">
{"dateModified":"2021-03-14T21:11:16+08:00","datePublished":"2021-03-14T21:11:16+08:00","url":"http://localhost:4000/daviddong.github.io/blog/github/2021/03/14/Blog-Jekyll-toc-plugin.html","@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/daviddong.github.io/BLOG"},"name":"david.dong"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/daviddong.github.io/blog/github/2021/03/14/Blog-Jekyll-toc-plugin.html"},"author":{"@type":"Person","name":"david.dong"},"headline":"Use jekyll-toc plugin on Github Pages","description":"This article introduced how to use jekyll-toc plugin on Github Pages.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->




</head>
  <body><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><main class="container">
      <section class="about">
        <a href="/daviddong.github.io/blog/index.html"><img src="/daviddong.github.io/assets/avatar.png" alt="David Dong"></a>
        <h2 id="title">
          <a href="/daviddong.github.io/blog/index.html">David Dong</a>
        </h2>
        <p class="tagline">Java/C/C#/Python</p>
		<!--add navigation --><nav class="navigation">
            <ul>
              
            </ul>
          </nav><!--put dark mode button here --><div>
		  <ul class = "social" >
			<p style = "font-family: Raleway, sans-serif;font-size: 100%">Dark Mode
			  <i class="icon-moon"></i>
			  <label class="switch">
				<input type="checkbox" id="dark-mode-toggle" onclick="toggleDarkMode()">
				<span class="slider round"></span>
			  </label>
			</p>
		  </ul>
		<script type="text/javascript" src="/daviddong.github.io/assets/js/darkmode.js"></script>
		</div><!--put rss/code link here -->
	    <div>
          <ul class="tool"><a style ="margin-right:10px; text-decoration: none" href="/daviddong.github.io/rss.xml">
              <span class="icon-rss-1 tooltip">
				<span class="tooltiptext">Rss</span>
			  </span>
           </a><a style="text-decoration: none" href="https://github.com/gangdong/daviddong.github.io">
              <span class="icon-file-code tooltip">
				<span class="tooltiptext">Code</span>
			  </span>
            </a></ul>
        </div>
	    <!--show contact me -->
	    <div class = "contact"><li>CONTACT ME</li></div>
		<!-- put social link here -->
		<div>
	      <ul class="social" >
		   <a href="https://rainbow-ux.github.io/traveler-blog.github.io">
              <li>
                <i class="icon-picture-3"></i>
              </li>
           </a><a href="https://github.com/gangdong">
              <li>
                <i class="icon-github-circled-1"></i>
              </li>
            </a><a href="https://www.linkedin.com/in/刚-董-25208ba0/">
              <li>
                <i class="icon-linkedin-squared"></i>
              </li>
            </a><a href="mailto:dqdongg@hotmail.com">
              <li>
                <i class="icon-mail" style = "font-size: 27px"></i>
              </li>
            </a></ul>
		</div>
		<!--put timestamp here -->
		<div class ="timestamp">&copy; 2021</div>
	  <!-- about box end here -->
      </section>
      <section class="content">
        


<!-- add menu bar here! -->


<div class="post-container">
	<div  class = "menu-meta">
		<div  class = "menu-logo" style="margin-top: 20px">BLOG</div>
		<div  class = "menu" style = "margin-top: 20px">
			<a class = "icon-doc-text icon_font" href="/daviddong.github.io/blog/index.html">Posts</a><a  class = "icon-archive-1 icon_font" href="/daviddong.github.io/archive">Archives</a><a  class = "icon-tags-1 icon_font" href="/daviddong.github.io/category">Categories</a><a  class = "icon-help-circled-3 icon_font" href="/daviddong.github.io/about">About</a>
		</div>
	</div>
</div><div class="post-container">
  <li class="posts-labelgroup" id="posts-labelgroup">
	<h1 id="posts-label">POST</h1>
  </li>  
  <a class="post-link" href="/daviddong.github.io/blog/github/2021/03/14/Blog-Jekyll-toc-plugin.html">
    <h2 class="post-title">Use jekyll-toc plugin on Github Pages</h2>
  </a>
   <div class="post-meta">
    <div class="post-date icon-calendar" style = "padding-left:0px;font-size:14px">Mar 14, 2021</div>
  </div>
  <br>
</div>
  <!-- post content here! -->
  <!-- set fix width box to put content! -->
  <div class="post-viewer-container">
	<div class="post-fix-width">
		<p>Today I want to add a auto TOC function to my blog. I used to write TOC manually and it is really boring. I found a good plugin <a href="https://Github.com/toshimaru/jekyll-toc">jekyll-toc</a> in the Github, which can fully meet my requirement.</p>

<h2 id="start">Start</h2>

<p>The installation is simple, I forked and installed the plugin successfully in 5 minutes.</p>

<p>After then, I was going to separate the TOC and post contents. I designed a sidebar to show the TOC independently by placing the <code class="language-plaintext highlighter-rouge">{% toc %}</code> tag into the sidebar.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- put sidebar! --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post-index-container"</span><span class="nt">&gt;</span>
	{% if page.language == 'chinese' %}
		<span class="nt">&lt;li</span> <span class="na">class = </span><span class="s">"post-index"</span><span class="nt">&gt;</span>文章目录<span class="nt">&lt;/li&gt;</span>
	{% else %}
		<span class="nt">&lt;li</span> <span class="na">class = </span><span class="s">"post-index"</span><span class="nt">&gt;</span>On this page<span class="nt">&lt;/li&gt;</span>
	{% endif %}
		<span class="nt">&lt;li&gt;</span>{% toc %}<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>I built the code locally by Jekyll and reloaded the page.</p>

<p>Cheers!</p>

<p>The TOC appeared, this was just what I want!</p>

<h2 id="i-got-a-trouble">I got a trouble</h2>

<p>Things are going really well so far, it is so easy?</p>

<p>No, I got a trouble when I committed the change to Github repository. The site was built failed by Github Pages generator.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">The tag <span class="sb">`</span>toc<span class="sb">`</span> on line 32 <span class="k">in</span> <span class="sb">`</span>/_layouts/post.html<span class="sb">`</span> is not a recognized Liquid tag.</code></pre></figure>

<p>I realized immediately that this plugin wasn’t in the <a href="https://pages.Github.com/versions/">whitelist</a> of Github Pages. I forgot that!</p>

<p><img src="/daviddong.github.io/assets/image/blog-jekyll-toc-01.PNG" alt="notification" class="center-image" /></p>

<p>I have to use a trick way to skip the restriction. As above bulletin showed, I need to build the site locally and push the generated static files to my Github repository ( <strong>Don’t use Github Pages generator build</strong>).</p>

<h2 id="use-master-branch">Use Master branch</h2>

<p>Followed above information I checked the root path in my Github Pages, it was <code class="language-plaintext highlighter-rouge">master</code> branch.</p>

<p>So I added the site file <code class="language-plaintext highlighter-rouge">_site/</code> to the master branch and pushed to origin repository.</p>

<p>I referred two articles<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup> here.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">git add _site/
git commit <span class="nt">-m</span> <span class="s2">"add static site file"</span>
git push origin master</code></pre></figure>

<p><strong>However, it didn’t work!</strong></p>

<h2 id="use-gh-pages-branch">Use gh-pages branch</h2>

<p>There should be something wrong with above procedure.</p>

<p>I went back to google search for another solution.</p>

<p>Thanks to these two articles<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup>.</p>

<p>I made it clear when I build the site by Github Pages generator, it actually creates a new branch <code class="language-plaintext highlighter-rouge">gh-pages</code> under master branch, in where it stores the static site files for external accessing. Therefore I need to create the <code class="language-plaintext highlighter-rouge">gh-pages</code> branch and place my <code class="language-plaintext highlighter-rouge">_site\</code> to there.</p>

<p>I changed the command as below.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">git checkout <span class="nt">-b</span> gh-pages
<span class="nb">cp</span> <span class="nt">-r</span> _site/<span class="k">*</span> <span class="nb">.</span>
git add _site
git commit <span class="nt">-m</span> <span class="s2">"add site files"</span>
git push origin gh-pages</code></pre></figure>

<p><img src="/daviddong.github.io/assets/image/blog-jekyll-toc-02.PNG" alt="master-root" /></p>

<p><strong>It worked this time!</strong></p>

<p><img src="/daviddong.github.io/assets/image/blog-jekyll-toc-04.PNG" alt="toc@sidebar" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>If you want to deploy your personal website on Github Pages with the unsupported plugins, you will need to build you site locally and create <code class="language-plaintext highlighter-rouge">gh-pages</code> branch and upload your site file to this branch. One important point is that you should use the branch as the root, which means placing the site file into the directory directly instead of a sub-directory.</p>

<p><img src="/daviddong.github.io/assets/image/blog-jekyll-toc-03.PNG" alt="master-root" /></p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><a href="">https://mccxj.Github.io/blog/20130127_jekyll-plugin-with-git-branch.html</a> <a href="">https://www.cnblogs.com/ihardcoder/p/4479356.html</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><a href="https://www.it1352.com/798173.html">https://www.it1352.com/798173.html</a> <a href="https://www.it1352.com/798173.html">https://www.cnblogs.com/pengshuo/p/5368035.html</a>, <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

	</div>
	<!-- put sidebar! -->
	
	<div class = "sidebar-container">
	    
	    <div class = "sidebar-about-box">
		    
				<li class = "sidebar-title">About This Article</li>
			
			
				
					<li class = "sidebar-about-content sidebar-font-big">This article introduced how to use jekyll-toc plugin on Github Pages.</li>
				
				
					<li class = "icon-link-1 sidebar-about-content sidebar-font-big" style = "margin-top:30px">Author: <a href="https://github.com/gangdong">david.dong</a></li>
				
					<li class = "icon-clock-5 sidebar-about-content sidebar-font-big">7 mins to read</li>
					<li class = "icon-book-1 sidebar-about-content sidebar-font-big">2459 words</li>
				
					<li class = "icon-th-list-1 sidebar-about-content sidebar-font-big">Key Words: jekyll-toc/Github Pages</li>
				
				
				    <li class = "icon-hashtag sidebar-about-content sidebar-font-medium">Tags: 
					
					<a href="/daviddong.github.io/category#Blog">Blog&nbsp;</a>
					
					<a href="/daviddong.github.io/category#Github">Github&nbsp;</a>
					
					</li>
				
			
		</div>
		
		
	    <div class="sidebar-toc-box">
			
			<li class = "sidebar-title">Table of Content</li>
			<li class = "sidebar-font-big sidebar-toc-content"><ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#start">Start</a></li>
<li class="toc-entry toc-h2"><a href="#i-got-a-trouble">I got a trouble</a></li>
<li class="toc-entry toc-h2"><a href="#use-master-branch">Use Master branch</a></li>
<li class="toc-entry toc-h2"><a href="#use-gh-pages-branch">Use gh-pages branch</a></li>
<li class="toc-entry toc-h2"><a href="#conclusion">Conclusion</a></li>
</ul></li>
			
		</div>
		
	</div>
	 
  </div>
  <!-- no sidebar, use flex width box! -->
  <br><br><br>
  <div class="post-container">
  
  <div class = "share-box-meta">
  <!-- Go to www.addthis.com/dashboard to customize your tools -->
	
	<div class="addthis_inline_share_toolbox share-box"><span style ="padding: 2px">Share:</span></div>
	
	<!-- Put post veiw statistic here! -->
	<div class = "post-view">
		<li class = "icon-eye">&nbsp;<span id="busuanzi_value_page_pv"></span></li>
	</div>
  </div>
  
  <!-- Related posts start here! -->
		
		<h1 id="posts-label">You may also like</h1>
		
	  <div class = "related-posts-box">
		<ul>
			
			<li><a href="/daviddong.github.io/blog/github/2018/03/23/Github-github-blog.html">How to build your personal blog on Github Pages</a></li>
			
			<li><a href="/daviddong.github.io/github/2015/06/06/Github-gitignore.html">A way to fix .gitignore doesn&#39;t work</a></li>
			
			<li><a href="/daviddong.github.io/blog/2021/03/20/Blog-mathjax.html">Display mathematics formula in blog with MathJax</a></li>
			
			<li><a href="/daviddong.github.io/blog/2021/03/20/Blog-travisci.html">Display mathematics formula in blog with MathJax</a></li>
			
			<li><a href="/daviddong.github.io/blog/2021/03/08/Web-gitalk-fixing.html">A quick way to fix the Gitalk Error: Validation Failed</a></li>
			
		</ul>
	  </div>
	  
	
  <!-- Page navigation start here! -->
   <h1 id="posts-label">further reading</h1>
  
  <div class = "separator"></div>
  <div class="navigation-meta" style = "margin-bottom:40px"><ul class="navigation-bar" style = "margin-top:40px; min-width:40%">
	 
	 <a href="/daviddong.github.io/blog/2021/03/08/Web-gitalk-fixing.html"; style="width:100%"><span class = "navigation-bar-label">Previous Post</span><br>A quick way to fix the Gitalk Error: Validation Failed</a>
	 
    </ul><ul class="navigation-bar" style = "margin-top:40px; min-width:40%"> 
	 
     <a href="/daviddong.github.io/blog/2021/03/20/Blog-mathjax.html"; style="width:100%"><span class = "navigation-bar-label">Next Post</span><br>Display mathematics formula in blog with MathJax</a>
	 
    </ul></div><br>
  <!-- comment box starts here! -->
    <!-- disqus start  --><!-- Gitalk start  -->
  <!-- Link Gitalk support file  -->
  <section class="gitalk">
  <div id="gitalk_thread"></div>
  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script type="text/javascript" src="/daviddong.github.io/assets/js/md5.min.js"></script>
  <div id="gitalk-container"></div>
  <script type="text/javascript">
   var gitalk = new Gitalk({
   // gitalk parameters
   clientID: '5e24fc307693a6df3bc5',
   clientSecret: '28c9c17e1174c705c42e9bdc92f87cadcc4ec8b8',
   repo: 'daviddong.github.io',
   owner: 'gangdong',
   admin: ['gangdong'],
   id: md5(location.pathname),
   title: 'comments'
    });
   gitalk.render('gitalk-container');
  </script>
  </section>
  <!-- Gitalk end -->
  <br/><br/><br/><div class = "footer">© 2012-2021 David Dong. All rights reserved.</div>
  
  <br>
</div>

      </section>
    </main>
<script src="/daviddong.github.io/assets/js/simple-jekyll-search.min.js"></script>
<script src="/daviddong.github.io/assets/js/search.js"></script>


<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-604f502a8198c9c9"></script>

</body>
</html>
